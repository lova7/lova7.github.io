<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="Storm重要概念
Topologies
Streams
Spouts
Bolts
Stream groupings
Reliability
Tasks
Workers

TopologyTopology (拓扑结构) 相当于一个服务，通过TopologyBuilder的createTopology方法创建，由StormSubmitter提交。下面是demo。
TopologyBuilder bu">
<meta property="og:type" content="article">
<meta property="og:title" content="storm 概念">
<meta property="og:url" content="http://yoursite.com/2016/07/21/storm-概念/index.html">
<meta property="og:site_name" content="Lova">
<meta property="og:description" content="Storm重要概念
Topologies
Streams
Spouts
Bolts
Stream groupings
Reliability
Tasks
Workers

TopologyTopology (拓扑结构) 相当于一个服务，通过TopologyBuilder的createTopology方法创建，由StormSubmitter提交。下面是demo。
TopologyBuilder bu">
<meta property="og:updated_time" content="2016-07-21T08:21:32.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="storm 概念">
<meta name="twitter:description" content="Storm重要概念
Topologies
Streams
Spouts
Bolts
Stream groupings
Reliability
Tasks
Workers

TopologyTopology (拓扑结构) 相当于一个服务，通过TopologyBuilder的createTopology方法创建，由StormSubmitter提交。下面是demo。
TopologyBuilder bu">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> storm 概念 | Lova </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Lova</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">今天天气很好</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                storm 概念
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-21T15:31:16+08:00" content="2016-07-21">
              2016-07-21
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Storm重要概念"><a href="#Storm重要概念" class="headerlink" title="Storm重要概念"></a>Storm重要概念</h1><ol>
<li><strong>Topologies</strong></li>
<li><strong>Streams</strong></li>
<li><strong>Spouts</strong></li>
<li><strong>Bolts</strong></li>
<li><strong>Stream groupings</strong></li>
<li><strong>Reliability</strong></li>
<li><strong>Tasks</strong></li>
<li><strong>Workers</strong></li>
</ol>
<h2 id="Topology"><a href="#Topology" class="headerlink" title="Topology"></a>Topology</h2><p><strong>Topology</strong> (拓扑结构) 相当于一个服务，通过TopologyBuilder的createTopology方法创建，由StormSubmitter提交。下面是demo。</p>
<pre><code>TopologyBuilder builder = new TopologyBuilder();

builder.setSpout(&quot;1&quot;, new TestWordSpout(true), 5);
builder.setSpout(&quot;2&quot;, new TestWordSpout(true), 3);
builder.setBolt(&quot;3&quot;, new TestWordCounter(), 3)
         .fieldsGrouping(&quot;1&quot;, new Fields(&quot;word&quot;))
         .fieldsGrouping(&quot;2&quot;, new Fields(&quot;word&quot;));
builder.setBolt(&quot;4&quot;, new TestGlobalCount())
         .globalGrouping(&quot;1&quot;);

Map conf = new HashMap();
conf.put(Config.TOPOLOGY_WORKERS, 4);

StormSubmitter.submitTopology(&quot;mytopology&quot;, conf, builder.createTopology());
</code></pre><p>#Streams</p>
<p>Tuple是storm中的基本数据结构，可以包含 <strong><em>int</em></strong>、<strong><em>long</em></strong>、<strong><em>short</em></strong>、<strong><em>byte</em></strong>、<strong><em>string</em></strong>、<strong><em>double</em></strong>、<strong><em>float</em></strong>、<strong><em>boolean</em></strong>、<strong><em>byte[]</em></strong>、<strong><em>自定义可序列化类</em></strong>。Stream是由一系列的Tuple流组成的数据流，并指定Tuple各Field的name.</p>
<p>#Spouts</p>
<p>Spout通常读取外部数据，并将之发送到Topology中。Spout可以通多调用OutputFieldsDeclarer 的declareStream方法声明多条stream。</p>
<p>#Bolts<br>Bolt接收Spout发送的数据，对数据进行过滤、业务处理等，也可以通过OutputFieldsDeclare声明多条Stream, 发送数据给其他Bolt。</p>
<p>#Stream groupings<br>Spout与Bolt数据分发函数有</p>
<pre><code>1. Shuffle grouping
   随机发送给后续bolt的tasks，数据基本均匀
2. Fields grouping
   根据stream中指定field的值进行分发，相当于hash，数据均匀不能保证。
   一般根据业务逻辑选择使用。
3. Partial Key grouping
    与Fields Grouping类似，但当数据不均匀时会自行均衡，慎用。
4. All grouping
    所有的task都会受到数据。
5. Global grouping
    所有数据发送给Bolt所有task中id最小的task。
6. None grouping
    与shuffle grouping相同
7. Direct grouping
    1. 意味着用户指定那个consumer的task接收数据
    2. Spout或Bolt必须声明direct streams
    3. 使用emitDirect方法发送数据
8. Local or shuffle grouping
    如果目标Bolt的一个进程中含有多个task, 数据只会发送到其中的一个task中。
    否则，等同于shuffle grouping.
</code></pre><p>#Reliability<br>当开启ack时，spout会追踪Tuple是否被处理，如果在指定时间内没被处理（默认30秒），spout会重发数据。涉及 ack, anchoring机制，详见<a href="http://storm.apache.org/releases/1.0.1/Guaranteeing-message-processing.html" target="_blank" rel="external">官网文档</a>。后续会写文档详述相关逻辑。</p>
<p>#Tasks<br>TopologyBuilder创建会指定Worker、executor、task数量，storm会根据该信息进行任务分发。</p>
<p>#Workers<br>Topology执行时的进程数。</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/21/storm配置项说明/" rel="next" title="storm配置项说明">
                <i class="fa fa-chevron-left"></i> storm配置项说明
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/07/21/storm任务调度/" rel="prev" title="storm任务调度">
                storm任务调度 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/1.jpg"
               alt="lova" />
          <p class="site-author-name" itemprop="name">lova</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">8</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Storm重要概念"><span class="nav-number">1.</span> <span class="nav-text">Storm重要概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Topology"><span class="nav-number">1.1.</span> <span class="nav-text">Topology</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lova</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>
